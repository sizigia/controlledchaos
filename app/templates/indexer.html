{% extends "base.html" %}

{% include 'navbar.html' %}

{% block content %}

<ul class="list-group">
    {% for topic, files in topic_files.items() %}
    <div data-toggle="collapse" href="{{ '#collapseFileTable_{}'.format(files['topic_n']) }}" role="button"
        aria-expanded="false" aria-controls="{{ 'collapseFileTable_{}'.format(files['topic_n']) }}">
        <li class="list-group-item"><strong>{{ 'Cluster ' + topic[-1] }}</strong> ({{ files['files']|length }} files)
        </li>
        {% if files['files']|length > 0 %}
        <div class="collapse" id="{{ 'collapseFileTable_{}'.format(files['topic_n']) }}">
            <div class="card card-body">
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col"></th>
                            <th scope="col">Filename</th>
                            <!--th scope="col">Last modified on</th-->
                            <th scope="col">File Type</th>
                            <th scope="col">Size (MB)</th>
                            <th scope="col"></th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for i in range(files['files']|length) %}
                        <tr>
                            <th scope="row"><img
                                    src={{ '../static/img/{}.svg'.format((icon[files['files'][i]['extension']] or icon['no-icon'])) }}
                                    alt="" width="20em" height="20em"></th>
                            {% if files['files'][i]['extension'] == 'folder' %}
                            <td>{{ files['files'][i]['name'] }}</td>
                            {% else %}
                            <td>{{ files['files'][i]['name'] }}</td>
                            {% endif %}
                            <!--td>{{ files['files'][i]['last_modified_on'] }}</td-->
                            {% if files['files'][i]['extension'] == 'folder' %}
                            <td>{{ files['files'][i]['extension']|capitalize }}</td>
                            {% else %}
                            <td>{{ files['files'][i]['extension'] }}</td>
                            {% endif %}
                            <td>{{ "%.2f"|format(files['files'][i]['size_mb']) }}</td>
                            <td>
                                <div class="row">
                                    <div class="col">
                                        <form action={{ url_for('open_file') }} method="POST">
                                            <button type="submit" class="btn btn-primary" id="filepath" name="filepath"
                                                value={{ files['files'][i]['absolute_path'] }}>
                                                Open
                                            </button>
                                        </form>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {%endfor%}
                    </tbody>
                </table>
            </div>
        </div>
        {%endif%}
    </div>
    {% endfor %}
</ul>

{% endblock %}